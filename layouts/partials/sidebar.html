{{ $currNode := . }}
<div id="sidebar" class="nav-collapse">
  <ul class="sidebar-menu"> 
    <li class="hidemenu"><a href="" class=""><i class="fa fa-angle-double-left"></i></a></li>

    {{if $SecIsM := (index .Site.Menus .Section)}}
    {{ range $SecIsM }}
      {{$currCat := index $currNode.Site.Taxonomies.categories .Identifier}}
      {{$currIsM:= $currNode.IsMenuCurrent $currNode.Section .}}
      {{$currHasM := or ($currNode.HasMenuCurrent $currNode.Section .) (in $currNode.Params.categories .Identifier)}}
      {{ if or (or $currHasM .HasChildren) $currCat.Len}}
        <li class="sub-menu{{if or $currIsM $currHasM}} active{{end}}">
          <a class="" href="{{.URL}}">
            <span class="menu-arrow fa {{if $currHasM}}fa-angle-down{{else}}fa-angle-right{{end}}"></span>
            <i class="fa fa-{{ .Pre }}"></i>
            <span>{{.Name}}</span>
          </a>
          <ul class="sub{{if $currHasM}} open{{end}}">
            {{ range .Children.ByName }}
              <li class="{{if ($currNode.IsMenuCurrent $currNode.Section .)}}active{{end}}">
                <a href="{{.URL}}"><i class="fa fa-caret-right"></i>{{.Name}}</a>
              </li>
            {{end}}
            {{range $currCat.Pages}}
              <li class="{{if eq $currNode.LinkTitle .LinkTitle}}active{{end}}">
                <a href="{{.RelPermalink}}"><i class="fa fa-caret-right"></i>{{.LinkTitle}}</a>
              </li>
            {{end}}
          </ul>
        </li>
      {{else}}
        <li class="{{if $currIsM}}active{{end}}">
          <a class="" href="{{.URL}}">
            <i class="fa fa-{{ .Pre }}"></i>
            <span>{{.Name}}</span>
          </a>
        </li>
      {{end}}
    {{end}}
    {{end}}
    <!-- <li> <a href="https://github.com/spf13/hugo/issues" target="blank"><i class='fa fa-life-ring'></i> <span>Issues & Help</span></a> </li> -->
  </ul>
</div>
